lingo:
    version: "builtin-beta-1"

modules:
    auth:
        name:
            lower_case: "auth"

        ops:

            create_user:
                name:
                    lower_case: "create user"
                description: "Create a new user with name and email"
                python:
                    call: "auth.create_user"
                params:
                    name:
                        name:
                            lower_case: "name"
                        type: str
                        description: "Name of the user"
                    email:
                        name:
                            lower_case: "email"
                        type: str
                        description: "Email of the user"
                    password:
                        name:
                            lower_case: "password"
                        type: str
                        description: "Password for the user"
                    password_confirm:
                        name:
                            lower_case: "password confirm"
                        type: str
                        description: "Password confirmation"
                output:
                    id:
                        name:
                            lower_case: "id"
                        type: int
                        description: "ID of the created user"
                    name:
                        name:
                            lower_case: "name"
                        type: str
                        description: "Name of the created user"
                    email:
                        name:
                            lower_case: "email"
                        type: str
                        description: "Email of the created user"


            login_user:
                name:
                    lower_case: "login user"
                description: "Login a user with email and password"
                python:
                    import: "from mapp.auth import login_user"
                    call: "login_user"
                params:
                    email:
                        name:
                            lower_case: "email"
                        type: str
                        description: "Email of the user"
                    password:
                        name:
                            lower_case: "password"
                        type: str
                        description: "Password for the user"
                output:
                    access_token:
                        name:
                            lower_case: "access token"
                        type: str
                        description: "Access token for the logged in user"
                    token_type:
                        name:
                            lower_case: "token type"
                        type: str
                        description: "Type of the token"


            current_user:
                name:
                    lower_case: "current user"
                description: "Get the current logged in user"
                python:
                    import: "from mapp.auth import current_user"
                    call: "current_user"
                params: {}
                output:
                    id:
                        name:
                            lower_case: "id"
                        type: int
                        description: "ID of the current user"
                    name:
                        name:
                            lower_case: "name"
                        type: str
                        description: "Name of the current user"
                    email:
                        name:
                            lower_case: "email"
                        type: str
                        description: "Email of the current user"


            logout_user:
                name:
                    lower_case: "logout user"
                description: "Logout the current user"
                python:
                    import: "from mapp.auth import logout_user"
                    call: "logout_user"
                params: {}
                output:
                    acknowledged:
                        name:
                            lower_case: "acknowledged"
                        type: bool
                        description: "Whether the logout was successful"
                    message:
                        name:
                            lower_case: "message"
                        type: str
                        description: "Acknowledgement message"


            delete_user:
                name:
                    lower_case: "delete user"
                description: "Delete currently logged in user"
                python:
                    import: "from mapp.auth import delete_user"
                    call: "delete_user"
                params: {}
                output:
                    acknowledged:
                        name:
                            lower_case: "acknowledged"
                        type: bool
                        description: "Whether the deletion was successful"
                    message:
                        name:
                            lower_case: "message"
                        type: str
                        description: "Acknowledgement message"

        models:
            user:
                hidden: true
                name:
                    lower_case: "user"

                fields:
                    name:
                        name:
                            lower_case: "name"
                        type: str
                        examples:
                            - "alice"
                            - "bob"

                    email:
                        name:
                            lower_case: "email"
                        type: str
                        examples:
                            - "alice@example.com"
                            - "bob@example.com"

            password_hash:
                hidden: true
                name:
                    lower_case: "password hash"

                fields:
                    hash:
                        name:
                            lower_case: "hash"
                        type: str
                        examples:
                            - "hashed_password_1"
                            - "hashed_password_2"

                    user_id:
                        name:
                            lower_case: "user id"
                        type: foreign_key
                        references:
                            table: "user"
                            field: "id"
                        examples:
                            - "1"
                            - "2"
